# Survey

## HMS - Harmful Brain Activity Classification

### Understanding Competition Data and EfficientNetB2 Starter - LB 0.43 🎉

https://www.kaggle.com/competitions/hms-harmful-brain-activity-classification/discussion/468010


- Q.
  - 106,800行のtrain.csvに対し、以下の件数しかない
    - unique `eeg_id`: 17089
    - unique `spectrogram_id`: 11138
    - unique `partient_id`: 1950


- A.
  - train.csvの各行は、一人の特定の患者からの`window of time`
  - 対応するEEGとスペクトログラムはparquetファイルで見つけられる


- KaggleDatasetあり
  - https://www.kaggle.com/datasets/cdeotte/brain-spectrograms
  - 11138のスペクトログラムファイルを1つにまとめた
  - 一気にRAMに読み込んでおくことで、逐一ファイルを読み込むより高速になる

#### 感想

- あまり理解できていない
  - それぞれのeegの時間中央値の値を用いて推論を行う？

#### 備考

EEGとスペクトログラムの関係性 by ChatGPT

```
EEG（脳波信号）からスペクトログラムへの変換は、信号の時間領域表現から周波数領域表現への変換プロセスです。この変換により、信号の周波数成分が時間とともにどのように変化するかを視覚的に表現できます。以下は、この変換プロセスの一般的なステップです。

### 1. 時間領域のEEG信号
EEG信号は、脳の電気活動を時間とともに記録したものです。これらの信号は、脳波の形で表され、通常はミリ秒単位で電圧の変化を示します。

### 2. 短時間フーリエ変換（STFT）
スペクトログラムを生成するためには、まずEEG信号に短時間フーリエ変換（STFT）を適用します。STFTは、信号を短いセグメントに分割し、各セグメントにフーリエ変換を適用して周波数成分を抽出します。これにより、各セグメントの周波数成分とそのセグメントが発生した時間が得られます。

### 3. パワースペクトルの計算
各セグメントのフーリエ変換から、パワースペクトルを計算します。パワースペクトルは、各周波数成分の強度（パワー）を示し、信号のエネルギーがどの周波数に集中しているかを示します。

### 4. スペクトログラムの生成
STFTから得られたパワースペクトルを時間軸に沿って並べることで、スペクトログラムが生成されます。スペクトログラムは2次元の画像で、横軸が時間、縦軸が周波数、色の濃淡（または色相）がパワースペクトルの強度を示します。

### 5. データの視覚化
最終的に、スペクトログラムを用いて、EEG信号の時間的および周波数的特性を視覚的に分析できます。たとえば、睡眠段階、瞑想の状態、または特定の認知タスクを実行している間に脳活動がどのように変化するかを調べることができます。

このプロセスは、Pythonの`matplotlib`や`scipy`ライブラリを使用して実装できます。特に`scipy.signal.spectrogram`関数は、EEGデータから直接スペクトログラムを生成するのに便利です。
```

時間と周波数の関係性 by ChatGPT

```
時間と周波数の関係性は信号処理や音響学、電磁波の研究など多くの分野で基本的な概念です。これら二つの概念は、信号や波形を解析する際に互いに補完的な情報を提供します。以下に、時間と周波数の関係性について基本的な説明をします。

### 時間ドメイン
時間ドメインにおける信号は、時間の経過に伴う振幅（強度や電圧など）の変化を表します。例えば、音声信号や心電図（ECG）は時間ドメインで表される典型的な例です。これらの信号では、時間が進むにつれて振幅がどのように変化するかを観察できます。

### 周波数ドメイン
周波数ドメインにおける信号は、信号が含む周波数成分とその強度（またはエネルギー）を表します。信号を周波数ドメインに変換することで、その信号がどの周波数を含んでいるか、各周波数成分の強度はどの程度かを知ることができます。この変換はフーリエ変換によって行われます。

### 時間と周波数のトレードオフ
時間ドメインと周波数ドメインの間には、トレードオフの関係があります。信号をより詳細に時間的に解析するほど、周波数に関する情報は曖昧になります。逆に、信号を周波数成分に分解して詳細に周波数情報を得るほど、それがいつ発生したのかについての時間的な情報は失われます。これは不確定性原理として知られており、信号処理において重要な考慮事項です。

### 時間-周波数解析
時間と周波数の情報を同時に得るために、短時間フーリエ変換（STFT）やウェーブレット変換などの時間-周波数解析手法が用いられます。これらの手法では、信号を時間的に局所化された小さなセグメントに分割し、各セグメントに対してフーリエ変換を適用することで、時間と周波数の情報を同時に表現します。

### まとめ
時間と周波数の関係性は、信号をどのように解析するかに基づいて異なる視点を提供します。時間ドメインでは信号の時間的変化を、周波数ドメインでは信号の周波数成分とその強度を捉えることができます。時間-周波数解析手法を用いることで、これら二つのドメインの情報を組み合わせて信号をより深く理解することが可能になります。
```

### 🧠📈 Beginner's EDA 📈🧠

https://www.kaggle.com/code/clehmann10/beginner-s-eda

- train.csvなどの統計データが詳しく載っている
- あまり読み込めてないので、後で読む


###

- LBの向上させ方
  - スペクトログラムからさらに特徴を作れる
  - 各eeg_idに対して、10（または任意の）サンプルを作成し、各サンプルが異なる10分間のspectrogram windowを使うことも可能
    - ランダムクロップデータの増強のようなイメージ
    - これにより10倍のデータが作成される
  - eeg parquetsから特徴量を生成することもできる
